# using Pkg
# Pkg.add("Plots")
using Plots

data = [
0.944863062 -1.06148 -1.06148 -1.08731
1.039349369 -1.09383 -1.09383 -1.1198
1.133835675 -1.11393 -1.11393 -1.14002
1.228321981 -1.12535 -1.12535 -1.15153
1.322808287 -1.1305 -1.1305 -1.15677
1.417294593 -1.13112 -1.13112 -1.15748
1.5117809 -1.12843 -1.12843 -1.1549
1.606267206 -1.12335 -1.12335 -1.14995
1.700753512 -1.11652 -1.11652 -1.14329
1.795239818 -1.10844 -1.10844 -1.13542
1.889726125 -1.09948 -1.09948 -1.12673
1.984212431 -1.08991 -1.08991 -1.1175
2.078698737 -1.07994 -1.07994 -1.10793
2.173185043 -1.06974 -1.06974 -1.0982
2.26767135 -1.05942 -1.05942 -1.08843
2.362157656 -1.04909 -1.04971 -1.07872
2.456643962 -1.03881 -1.04147 -1.06915
2.551130268 -1.02865 -1.03451 -1.05978
2.645616574 -1.01865 -1.02864 -1.05066
2.740102881 -1.00884 -1.02368 -1.04182
2.834589187 -0.99924 -1.0195 -1.03329
2.929075493 -0.98988 -1.01597 -1.02509
3.023561799 -0.98076 -1.01299 -1.01722
3.118048106 -0.97189 -1.01048 -1.00969
3.212534412 -0.96327 -1.00836 -1.0025
3.307020718 -0.9549 -1.00656 -0.99565
3.401507024 -0.94678 -1.00505 -0.98915
3.495993331 -0.93891 -1.00376 -0.98299
3.590479637 -0.93128 -1.00267 -0.97716
3.684965943 -0.92389 -1.00175 -0.97166
3.779452249 -0.91674 -1.00097 -0.96649
3.873938555 -0.90982 -1.0003 -0.96164
3.968424862 -0.90313 -0.99974 -0.95712
4.062911168 -0.89665 -0.99926 -0.9529
4.157397474 -0.8904 -0.99885 -0.949
4.25188378 -0.88436 -0.99851 -0.9454
4.346370087 -0.87852 -0.99821 -0.9421
4.440856393 -0.87289 -0.99796 -0.9391
4.535342699 -0.86745 -0.99775 -0.93638
4.629829005 -0.8622 -0.99757 -0.93395
4.724315312 -0.85714 -0.99742 -0.93179
4.818801618 -0.85226 -0.99729 -0.9299
4.913287924 -0.84755 -0.99718 -0.92828
5.00777423 -0.84302 -0.99708 -0.92691
5.102260536 -0.83865 -0.997 -0.9258
5.196746843 -0.83445 -0.99693 -0.92492
5.291233149 -0.8304 -0.99688 -0.92429
5.385719455 -0.82651 -0.99682 -0.92388
5.480205761 -0.82276 -0.99678 -0.9237
5.574692068 -0.81916 -0.99674 -0.92373
5.669178374 -0.8157 -0.99671 -0.92397
5.76366468 -0.81238 -0.99668 -0.92441
5.858150986 -0.8092 -0.99666 -0.92504
5.952637293 -0.80614 -0.99664 -0.92585
6.047123599 -0.8032 -0.99662 -0.92685
6.141609905 -0.80039 -0.9966 -0.928
6.236096211 -0.7977 -0.99658 -0.92932
6.330582517 -0.79511 -0.99657 -0.93079
6.425068824 -0.79264 -0.99656 -0.9324
6.51955513 -0.79028 -0.99655 -0.93415
6.614041436 -0.78802 -0.99654 -0.93603
6.708527742 -0.78585 -0.99653 -0.93803
6.803014049 -0.78378 -0.99652 -0.94014
6.897500355 -0.75834 -0.99652 -0.94811
6.991986661 -0.77992 -0.99651 -0.94467
7.086472967 -0.77811 -0.9965 -0.94707
7.180959274 -0.77639 -0.9965 -0.94956
7.27544558 -0.77474 -0.9965 -0.95213
7.369931886 -0.77316 -0.99649 -0.95478
7.464418192 -0.77166 -0.99649 -0.95749
7.558904499 -0.77022 -0.99649 -0.96026
7.653390805 -0.76885 -0.99648 -0.96308
7.747877111 -0.75694 -0.99648 -0.97268
7.842363417 -0.75664 -0.99648 -0.97545
7.936849723 -0.75633 -0.99648 -0.97823
8.03133603 -0.75599 -0.99647 -0.98103
8.125822336 -0.75565 -0.99647 -0.98384
8.220308642 -0.76179 -0.99647 -0.98099
8.314794948 -0.76078 -0.99647 -0.98409
8.409281255 -0.75982 -0.99647 -0.98723
8.503767561 -0.7589 -0.99647 -0.99038
8.598253867 -0.75801 -0.99647 -0.99356
8.692740173 -0.75716 -0.99647 -0.99675
8.78722648 -0.75634 -0.99647 -0.99996
8.881712786 -0.75555 -0.99647 -1.00319
8.976199092 -0.75479 -0.99647 -1.00643
9.070685398 -0.75407 -0.99647 -1.00969
9.165171704 -0.75336 -0.99647 -1.01295
9.259658011 -0.75268 -0.99647 -1.01623
9.354144317 -0.75203 -0.99647 -1.01951
9.448630623 -0.7514 -0.99647 -1.02281
9.543116929 -0.75078 -0.99647 -1.02611
9.637603236 -0.75019 -0.99647 -1.02942
9.732089542 -0.74962 -0.99647 -1.03274
9.826575848 -0.74906 -0.99647 -1.03606
9.921062154 -0.74852 -0.99647 -1.03939
10.01554846 -0.74799 -0.99647 -1.04273
10.11003477 -0.74748 -0.99647 -1.04607
10.20452107 -0.74698 -0.99647 -1.04941
10.29900738 -0.7465 -0.99647 -1.05277
10.39349369 -0.74603 -0.99647 -1.05613
10.48797999 -0.74557 -0.99647 -1.05949
10.5824663 -0.7448 -0.99647 -1.06361
10.6769526 -0.74468 -0.99647 -1.06624
10.77143891 -0.74425 -0.99647 -1.06962
10.86592522 -0.74383 -0.99647 -1.073
10.96041152 -0.74342 -0.99647 -1.07639
11.05489783 -0.74301 -0.99647 -1.07979
11.14938414 -0.74262 -0.99647 -1.08319
11.24387044 -0.74223 -0.99647 -1.0866
11.33835675 -0.74185 -0.99647 -1.09001
11.43284305 -0.74148 -0.99647 -1.09343
11.52732936 -0.74112 -0.99647 -1.09686
11.62181567 -0.74076 -0.99647 -1.10029
11.71630197 -0.74041 -0.99647 -1.10372
11.81078828 -0.74006 -0.99647 -1.10716
11.90527459 -0.73972 -0.99647 -1.11061
11.99976089 -0.73939 -0.99647 -1.11406
12.0942472 -0.73906 -0.99647 -1.11751
12.1887335 -0.73874 -0.99647 -1.12098
12.28321981 -0.73842 -0.99647 -1.12444
12.37770612 -0.73811 -0.99647 -1.12791
12.47219242 -0.7378 -0.99647 -1.13139
12.56667873 -0.7375 -0.99647 -1.13487
12.66116503 -0.7372 -0.99647 -1.13836
12.75565134 -0.73691 -0.99647 -1.14185
12.85013765 -0.73662 -0.99647 -1.14535
12.94462395 -0.73633 -0.99647 -1.14885
13.03911026 -0.73605 -0.99647 -1.15236
13.13359657 -0.73578 -0.99647 -1.15587
13.22808287 -0.73551 -0.99647 -1.15939
13.32256918 -0.73524 -0.99647 -1.16291
13.41705548 -0.73497 -0.99647 -1.16643
13.51154179 -0.73471 -0.99647 -1.16996
13.6060281 -0.73445 -0.99647 -1.17349
13.7005144 -0.7342 -0.99647 -1.17703
13.79500071 -0.73395 -0.99647 -1.18057
13.88948702 -0.7337 -0.99647 -1.18412
13.98397332 -0.73346 -0.99647 -1.18767
14.07845963 -0.73322 -0.99647 -1.19122
14.17294593 -0.73298 -0.99647 -1.19478
14.26743224 -0.73275 -0.99647 -1.19834
14.36191855 -0.73252 -0.99647 -1.20191
14.45640485 -0.73229 -0.99647 -1.20548
14.55089116 -0.73207 -0.99647 -1.20905
14.64537747 -0.73185 -0.99647 -1.21263
14.73986377 -0.73163 -0.99647 -1.21621
14.83435008 -0.73141 -0.99647 -1.21979
14.92883638 -0.7312 -0.99647 -1.22337
15.02332269 -0.73099 -0.99647 -1.22696
15.117809 -0.73078 -0.99647 -1.23056
15.2122953 -0.73057 -0.99647 -1.23415
]

# https://gaussian.com/wp-content/uploads/dl/vib.pdf
# Gaussianは二原子分子の換算質量が2倍になってしまうので、バネ定数は本来は半分のはず
# http://stemwomen.org/teach/QM/qm54.pdf
# バネ定数を原子単位に直す
k = 12.7722 / 15.56914 / 2
Ee = -1.13133356259
re = 1.38436
Et = -1.120768

plot(title="H2, UHF/6-31G**", xlabel="\$r\$", ylabel="\$E(r)\$", xlims=(0.4,3.1), ylims=(-1.15,-0.95), legend=:bottomright)
scatter!(data[:,1], data[:,2], label="SCAN", mc=1)
scatter!([1.38436], [-1.13133356259], label="OPT", mc=2)
plot!(0.2:0.01:2.5, r->1/2*k*(r-re)^2 + Ee, label="FREQ", lc=2, lw=2)
plot!([re-sqrt(2*abs(Et-Ee)/k), re+sqrt(2*abs(Et-Ee)/k)], fill(Et,2), label="", lc=2, lw=2)

plot!([0,re-sqrt(2*abs(Et-Ee)/k)], [Et,Et], label="", lc="#000000", lw=2, ls=:dot)
plot!([0,re], [Ee,Ee], label="", lc="#000000", lw=2, ls=:dot)
plot!([re,re], [Ee,-1.4], label="", lc="#000000", lw=2, ls=:dot)

X = 0.5
plot!([X, X], [Ee,Et], label="", lc="#00C864", lw=0, arrow=(:closed, 1))
plot!([X, X], [Et,Ee], label="", lc="#00C864", lw=0, arrow=(:closed, 1))
plot!([X, X], [Ee+0.01,Et-0.01], label="", lc="#00C864", lw=2.5)

savefig(PROGRAM_FILE * ".svg")
